unit funcoes;

interface

uses
  Classes, Windows, Forms, SysUtils, IniFiles, vcl.controls, vcl.Dialogs;

const
  NOME_ARQUIVO_CONFIG = '\config.ini';

type
  TFuncoes = class(TObject)
  private
    class procedure GetInstance;
    class procedure ReleaseInstance;
    constructor Create; reintroduce;
  public
    Destructor Destroy; Override;
    function LeIniStr(sPath: string; sSessao: string; sItend: string; sDefault: string): string;
    function ObterCaminhoBancoDados: string;
  end;

var
  Func: TFuncoes;




implementation


{ TFuncoes }

constructor TFuncoes.Create;
begin

end;

destructor TFuncoes.Destroy;
begin
  inherited;
end;

class procedure TFuncoes.GetInstance;
begin
  if not Assigned(Func) then
    Func := TFuncoes.Create;
end;

function TFuncoes.ObterCaminhoBancoDados: string;
var
  sNomeArqIni: string;
begin
  sNomeArqIni := ExtractFileDir(Application.ExeName) + NOME_ARQUIVO_CONFIG;
  if not FileExists(sNomeArqIni) Then
  begin
    ShowMessage('Arquivo de configuração não encontrado.');
    Application.Terminate;
    Exit;
  end;
  Result := LeIniStr(sNomeArqIni, 'Comunicacao', 'BaseDados', '');
end;

class procedure TFuncoes.ReleaseInstance;
begin
  if Assigned(Func) then
    Func.Free;
end;

Initialization

TFuncoes.GetInstance;

Finalization

TFuncoes.ReleaseInstance;

end.
